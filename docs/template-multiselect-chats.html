<!DOCTYPE html>
<!--
Template: Multi-Select Conversation Interface

OVERVIEW:
This template creates an interactive interface where users select from multiple conversation examples
to create a test set or evaluation collection. Perfect for AI evaluation, testing scenarios, or
conversation analysis tasks.

REQUIRED PLACEHOLDERS:

Basic Task Information:
- {{task_title}} - Main task title (e.g., "Task 4: Create a Smoke Test Set")
- {{scenario_title}} - Scenario context (e.g., "Recipe Chatbot")
- {{task_description}} - Brief task description
- {{task_detailed_description}} - Extended task explanation
- {{task_number}} - Task position indicator (e.g., "Task 4 of 5")

Selection Parameters:
- {{max_selections}} - Number of conversations to select (e.g., "3")
- {{selection_instructions}} - Instructions for selection (e.g., "Select conversations that represent different test scenarios")
- {{selection_criteria}} - Detailed selection criteria
- {{progress_description}} - Progress section description
- {{submit_button_text}} - Submit button text (e.g., "Create Smoke Test Set")

Data Source Context:
- {{data_source_title}} - Data source section title
- {{data_origin_description}} - Description of where conversations come from
- {{company_name}} - Company/organization name for context

Navigation:
- {{previous_task_link}} - Link to previous task
- {{previous_task_title}} - Title of previous task
- {{next_task_link}} - Link to next task
- {{next_task_title}} - Title of next task
- {{next_task_button_text}} - Text for next task button

Conversation Cards (9 total - conversation1 through conversation9):
For each conversation (1-9):
- {{conversationX_title}} - Conversation title
- {{conversationX_category}} - Category/type of conversation
- {{conversationX_customer_message}} - Customer's message
- {{conversationX_assistant_message}} - Assistant's response
- {{conversationX_tag1}} - First quality tag
- {{conversationX_tag2}} - Second quality tag
- {{conversationX_complexity}} - Complexity level for JavaScript analysis
- {{conversationX_usecase}} - Use case type for JavaScript analysis
- {{conversationX_diversity}} - Diversity category for JavaScript analysis

Feedback Content:
- {{feedback_title}} - Success feedback title
- {{coverage_analysis_title}} - Coverage analysis section title
- {{coverage_metric1_label}} through {{coverage_metric3_label}} - Coverage metric labels
- {{coverage_metric1_description}} through {{coverage_metric3_description}} - Coverage descriptions
- {{selection_summary_title}} - Summary section title
- {{selection_summary_description}} - Summary description
- {{selection_category1_label}} through {{selection_category5_label}} - Category labels
- {{selection_category1_description}} through {{selection_category5_description}} - Category descriptions
- {{next_step_description}} - Description of what happens next
- {{dynamic_feedback_title}} - Title for JavaScript-generated feedback

FEATURES:
- Interactive conversation selection with visual feedback
- Progress tracking and validation
- Comprehensive coverage analysis
- Personalized feedback based on selections
- Responsive grid layout for conversation cards
- Quality tags and categorization
- JavaScript-driven analysis and scoring

USAGE:
Replace all {{placeholder}} values with your specific content. Ensure all 9 conversations are defined
with their associated metadata for proper JavaScript analysis.
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{task_title}} - {{scenario_title}}</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }
        .navigation {
            background: #f6f8fa;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .nav-link {
            color: #0969da;
            text-decoration: none;
            font-weight: 500;
        }
        .nav-link:hover {
            text-decoration: underline;
        }
        .header {
            background: white;
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .instructions-banner {
            background: #e7f3ff;
            border: 1px solid #0969da;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        .selection-info {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .conversation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .conversation-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 0;
            transition: all 0.2s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        .conversation-card:hover {
            border-color: #0969da;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .conversation-card.selected {
            border-color: #0969da;
            background: #f0f9ff;
        }
        .conversation-card.selected::after {
            content: '✓';
            position: absolute;
            top: 10px;
            right: 15px;
            background: #0969da;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }
        .conversation-header {
            background: #f8f9fa;
            padding: 15px 20px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .conversation-title {
            font-weight: 600;
            color: #1f2937;
            margin: 0;
        }
        .conversation-category {
            font-size: 12px;
            color: #6b7280;
            text-transform: uppercase;
            font-weight: 500;
        }
        .conversation-content {
            padding: 20px;
        }
        .customer-message {
            background: #e7f3ff;
            border-radius: 12px;
            padding: 12px 16px;
            margin-bottom: 12px;
            position: relative;
        }
        .customer-message::before {
            content: 'C';
            position: absolute;
            left: -8px;
            top: -8px;
            background: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            color: #0969da;
        }
        .assistant-message {
            background: #f0fdf4;
            border-radius: 12px;
            padding: 12px 16px;
            position: relative;
        }
        .assistant-message::before {
            content: 'A';
            position: absolute;
            left: -8px;
            top: -8px;
            background: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            color: #16a34a;
        }
        .quality-tags {
            display: flex;
            gap: 8px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        .quality-tag {
            background: #f3f4f6;
            color: #374151;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }
        /* Query Complexity - Blue tones */
        .quality-tag.complexity {
            background: #dbeafe;
            color: #1e40af;
        }
        /* Information Type - Green tones */
        .quality-tag.information {
            background: #d1fae5;
            color: #065f46;
        }
        /* Use Cases - Purple tones */
        .quality-tag.usecase {
            background: #e9d5ff;
            color: #6b21a8;
        }
        /* Context/Urgency - Orange tones */
        .quality-tag.context {
            background: #fed7aa;
            color: #c2410c;
        }
        /* Legacy classes for backward compatibility */
        .quality-tag.high {
            background: #d1fae5;
            color: #065f46;
        }
        .quality-tag.medium {
            background: #fef3c7;
            color: #92400e;
        }
        .quality-tag.low {
            background: #fee2e2;
            color: #991b1b;
        }
        .progress-section {
            background: white;
            border-radius: 8px;
            padding: 25px;
            margin: 30px 0;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .progress-counter {
            font-size: 18px;
            font-weight: 600;
            color: #0969da;
            margin-bottom: 15px;
        }
        .submit-btn {
            background: #0969da;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
        }
        .submit-btn:disabled {
            background: #6b7280;
            cursor: not-allowed;
        }
        .feedback {
            background: white;
            border-radius: 8px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            display: none;
        }
        .feedback.show {
            display: block;
        }
        .coverage-check {
            background: #dcfce7;
            border: 1px solid #16a34a;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        .feedback-section {
            margin: 20px 0;
        }
        .feedback-item {
            background: #f8f9fa;
            border: 1px solid #d0d7de;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
        }
        .score-section {
            background: #e6f3ff;
            border: 1px solid #0969da;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            font-size: 18px;
            font-weight: 600;
        }
        .category-badge {
            background: #6b7280;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 10px;
        }
        .complexity-badge {
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 5px;
        }
        .complexity-badge.simple {
            background: #dcfce7;
            color: #166534;
        }
        .complexity-badge.medium {
            background: #fef3c7;
            color: #92400e;
        }
        .complexity-badge.complex {
            background: #fee2e2;
            color: #991b1b;
        }
        .coverage-item {
            padding: 10px;
            margin: 10px 0;
            border-radius: 6px;
            border-left: 4px solid #d0d7de;
        }
        .coverage-item.good {
            background: #f0fdf4;
            border-left-color: #16a34a;
        }
        .coverage-item.needs-improvement {
            background: #fffbeb;
            border-left-color: #f59e0b;
        }
        .coverage-badge {
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 3px;
            margin-right: 10px;
        }
        .coverage-badge.good {
            background: #dcfce7;
            color: #166534;
        }
        .coverage-badge.warning {
            background: #fef3c7;
            color: #92400e;
        }
        .overall-feedback {
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        .overall-feedback.success {
            background: #d1fae5;
            border: 1px solid #16a34a;
        }
        .overall-feedback.good {
            background: #fef3c7;
            border: 1px solid #d97706;
        }
        .overall-feedback.needs-work {
            background: #fee2e2;
            border: 1px solid #dc2626;
        }
        .testing-principles {
            background: #f0f9ff;
            border: 1px solid #0969da;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        .next-task {
            background: #0969da;
            color: white;
            padding: 12px 24px;
            border-radius: 6px;
            text-decoration: none;
            display: inline-block;
            margin-top: 20px;
            font-weight: 500;
        }
        .data-source-info {
            background: #fffbeb;
            border: 1px solid #f59e0b;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
        }
        .reset-section {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            border-top: 1px solid #e0e0e0;
        }
        .reset-btn {
            background: #6b7280;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        .reset-btn:hover {
            background: #4b5563;
        }
    </style>
</head>
<body>
    <div class="navigation">
        <a href="{{previous_task_link}}" class="nav-link">← {{previous_task_title}}</a>
        <span>{{task_number}}</span>
        <a href="{{next_task_link}}" class="nav-link">{{next_task_title}} →</a>
    </div>

    <div class="header">
        <h1>{{task_title}}</h1>
        <p>{{task_description}}</p>
    </div>

    <div class="instructions-banner">
        <h3>{{selection_instructions}}</h3>
        <div style="font-size: 14px; margin-top: 10px;">
            <strong>0 / {{max_selections}} selected</strong>
        </div>
    </div>

    <div class="data-source-info">
        <h3>{{data_source_title}}</h3>
        <p><strong>Data Origin:</strong> {{data_origin_description}}</p>
        <p><strong>Your Task:</strong> {{task_detailed_description}}</p>
        <p><strong>Selection Criteria:</strong> {{selection_criteria}}</p>
    </div>

    <div class="conversation-grid">
        <div class="conversation-card" onclick="toggleSelection(this, 'conversation-1')">
            <div class="conversation-header">
                <h4 class="conversation-title">{{conversation1_title}}</h4>
                <div class="conversation-category">{{conversation1_category}}</div>
            </div>
            <div class="conversation-content">
                <div class="customer-message">
                    {{conversation1_customer_message}}
                </div>
                <div class="assistant-message">
                    {{conversation1_assistant_message}}
                </div>
                <div class="quality-tags">
                    <span class="quality-tag complexity">{{conversation1_tag1}}</span>
                    <span class="quality-tag information">{{conversation1_tag2}}</span>
                </div>
            </div>
        </div>

        <div class="conversation-card" onclick="toggleSelection(this, 'conversation-2')">
            <div class="conversation-header">
                <h4 class="conversation-title">{{conversation2_title}}</h4>
                <div class="conversation-category">{{conversation2_category}}</div>
            </div>
            <div class="conversation-content">
                <div class="customer-message">
                    {{conversation2_customer_message}}
                </div>
                <div class="assistant-message">
                    {{conversation2_assistant_message}}
                </div>
                <div class="quality-tags">
                    <span class="quality-tag complexity">{{conversation2_tag1}}</span>
                    <span class="quality-tag complexity">{{conversation2_tag2}}</span>
                </div>
            </div>
        </div>

        <div class="conversation-card" onclick="toggleSelection(this, 'conversation-3')">
            <div class="conversation-header">
                <h4 class="conversation-title">{{conversation3_title}}</h4>
                <div class="conversation-category">{{conversation3_category}}</div>
            </div>
            <div class="conversation-content">
                <div class="customer-message">
                    {{conversation3_customer_message}}
                </div>
                <div class="assistant-message">
                    {{conversation3_assistant_message}}
                </div>
                <div class="quality-tags">
                    <span class="quality-tag information">{{conversation3_tag1}}</span>
                    <span class="quality-tag context">{{conversation3_tag2}}</span>
                </div>
            </div>
        </div>

        <div class="conversation-card" onclick="toggleSelection(this, 'conversation-4')">
            <div class="conversation-header">
                <h4 class="conversation-title">{{conversation4_title}}</h4>
                <div class="conversation-category">{{conversation4_category}}</div>
            </div>
            <div class="conversation-content">
                <div class="customer-message">
                    {{conversation4_customer_message}}
                </div>
                <div class="assistant-message">
                    {{conversation4_assistant_message}}
                </div>
                <div class="quality-tags">
                    <span class="quality-tag information">{{conversation4_tag1}}</span>
                    <span class="quality-tag information">{{conversation4_tag2}}</span>
                </div>
            </div>
        </div>

        <div class="conversation-card" onclick="toggleSelection(this, 'conversation-5')">
            <div class="conversation-header">
                <h4 class="conversation-title">{{conversation5_title}}</h4>
                <div class="conversation-category">{{conversation5_category}}</div>
            </div>
            <div class="conversation-content">
                <div class="customer-message">
                    {{conversation5_customer_message}}
                </div>
                <div class="assistant-message">
                    {{conversation5_assistant_message}}
                </div>
                <div class="quality-tags">
                    <span class="quality-tag usecase">{{conversation5_tag1}}</span>
                    <span class="quality-tag usecase">{{conversation5_tag2}}</span>
                </div>
            </div>
        </div>

        <div class="conversation-card" onclick="toggleSelection(this, 'conversation-6')">
            <div class="conversation-header">
                <h4 class="conversation-title">{{conversation6_title}}</h4>
                <div class="conversation-category">{{conversation6_category}}</div>
            </div>
            <div class="conversation-content">
                <div class="customer-message">
                    {{conversation6_customer_message}}
                </div>
                <div class="assistant-message">
                    {{conversation6_assistant_message}}
                </div>
                <div class="quality-tags">
                    <span class="quality-tag context">{{conversation6_tag1}}</span>
                    <span class="quality-tag context">{{conversation6_tag2}}</span>
                </div>
            </div>
        </div>

        <div class="conversation-card" onclick="toggleSelection(this, 'conversation-7')">
            <div class="conversation-header">
                <h4 class="conversation-title">{{conversation7_title}}</h4>
                <div class="conversation-category">{{conversation7_category}}</div>
            </div>
            <div class="conversation-content">
                <div class="customer-message">
                    {{conversation7_customer_message}}
                </div>
                <div class="assistant-message">
                    {{conversation7_assistant_message}}
                </div>
                <div class="quality-tags">
                    <span class="quality-tag usecase">{{conversation7_tag1}}</span>
                    <span class="quality-tag context">{{conversation7_tag2}}</span>
                </div>
            </div>
        </div>

        <div class="conversation-card" onclick="toggleSelection(this, 'conversation-8')">
            <div class="conversation-header">
                <h4 class="conversation-title">{{conversation8_title}}</h4>
                <div class="conversation-category">{{conversation8_category}}</div>
            </div>
            <div class="conversation-content">
                <div class="customer-message">
                    {{conversation8_customer_message}}
                </div>
                <div class="assistant-message">
                    {{conversation8_assistant_message}}
                </div>
                <div class="quality-tags">
                    <span class="quality-tag usecase">{{conversation8_tag1}}</span>
                    <span class="quality-tag complexity">{{conversation8_tag2}}</span>
                </div>
            </div>
        </div>

        <div class="conversation-card" onclick="toggleSelection(this, 'conversation-9')">
            <div class="conversation-header">
                <h4 class="conversation-title">{{conversation9_title}}</h4>
                <div class="conversation-category">{{conversation9_category}}</div>
            </div>
            <div class="conversation-content">
                <div class="customer-message">
                    {{conversation9_customer_message}}
                </div>
                <div class="assistant-message">
                    {{conversation9_assistant_message}}
                </div>
                <div class="quality-tags">
                    <span class="quality-tag usecase">{{conversation9_tag1}}</span>
                    <span class="quality-tag complexity">{{conversation9_tag2}}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="progress-section">
        <div class="progress-counter" id="progressCounter">0 of {{max_selections}} conversations selected</div>
        <p>{{progress_description}}</p>
        <button class="submit-btn" id="submitBtn" onclick="submitTestSet()" disabled>{{submit_button_text}}</button>
    </div>

    <div class="feedback" id="feedback">
        <h3>{{feedback_title}}</h3>
        
        <div class="coverage-check">
            <h4>{{coverage_analysis_title}}</h4>
            <p><strong>Total Conversations:</strong> {{max_selections}}/{{max_selections}}</p>
            <p><strong>{{coverage_metric1_label}}:</strong> {{coverage_metric1_description}}</p>
            <p><strong>{{coverage_metric2_label}}:</strong> {{coverage_metric2_description}}</p>
            <p><strong>{{coverage_metric3_label}}:</strong> {{coverage_metric3_description}}</p>
        </div>

        <div class="selection-info">
            <h4>{{selection_summary_title}}</h4>
            <p>{{selection_summary_description}}</p>
            <ul>
                <li><strong>{{selection_category1_label}}:</strong> {{selection_category1_description}}</li>
                <li><strong>{{selection_category2_label}}:</strong> {{selection_category2_description}}</li>
                <li><strong>{{selection_category3_label}}:</strong> {{selection_category3_description}}</li>
                <li><strong>{{selection_category4_label}}:</strong> {{selection_category4_description}}</li>
                <li><strong>{{selection_category5_label}}:</strong> {{selection_category5_description}}</li>
            </ul>
        </div>

        <p><strong>Next Step:</strong> {{next_step_description}}</p>
        
        <a href="{{next_task_link}}" class="next-task">{{next_task_button_text}}</a>
    </div>

    <div class="reset-section">
        <button class="reset-btn" onclick="location.reload()">Reset Exercise</button>
    </div>

    <script>
        let selectedConversations = new Set();
        const maxSelections = parseInt('{{max_selections}}');

        function toggleSelection(card, id) {
            if (selectedConversations.has(id)) {
                selectedConversations.delete(id);
                card.classList.remove('selected');
            } else if (selectedConversations.size < maxSelections) {
                selectedConversations.add(id);
                card.classList.add('selected');
            } else {
                alert(`You can only select ${maxSelections} conversations for the smoke test set.`);
                return;
            }
            
            updateProgress();
        }

        function updateProgress() {
            const selectedCount = selectedConversations.size;
            document.getElementById('progressCounter').textContent = `${selectedCount} of ${maxSelections} conversations selected`;
            document.getElementById('submitBtn').disabled = selectedCount < maxSelections;
            
            // Update the banner counter
            document.querySelector('.instructions-banner strong').textContent = `${selectedCount} / ${maxSelections} selected`;
        }

        function submitTestSet() {
            if (selectedConversations.size < maxSelections) {
                alert(`Please select ${maxSelections} conversations before creating the test set.`);
                return;
            }
            
            generatePersonalizedFeedback();
            document.getElementById('feedback').classList.add('show');
            document.querySelector('.progress-section').style.display = 'none';
            
            // Scroll to feedback section
            document.getElementById('feedback').scrollIntoView({ behavior: 'smooth' });
        }

        function generatePersonalizedFeedback() {
            // Define the conversation data with categories and ideal selection criteria
            const conversations = {
                'conversation-1': { category: '{{conversation1_category}}', complexity: '{{conversation1_complexity}}', usecase: '{{conversation1_usecase}}', diversity: '{{conversation1_diversity}}' },
                'conversation-2': { category: '{{conversation2_category}}', complexity: '{{conversation2_complexity}}', usecase: '{{conversation2_usecase}}', diversity: '{{conversation2_diversity}}' },
                'conversation-3': { category: '{{conversation3_category}}', complexity: '{{conversation3_complexity}}', usecase: '{{conversation3_usecase}}', diversity: '{{conversation3_diversity}}' },
                'conversation-4': { category: '{{conversation4_category}}', complexity: '{{conversation4_complexity}}', usecase: '{{conversation4_usecase}}', diversity: '{{conversation4_diversity}}' },
                'conversation-5': { category: '{{conversation5_category}}', complexity: '{{conversation5_complexity}}', usecase: '{{conversation5_usecase}}', diversity: '{{conversation5_diversity}}' },
                'conversation-6': { category: '{{conversation6_category}}', complexity: '{{conversation6_complexity}}', usecase: '{{conversation6_usecase}}', diversity: '{{conversation6_diversity}}' },
                'conversation-7': { category: '{{conversation7_category}}', complexity: '{{conversation7_complexity}}', usecase: '{{conversation7_usecase}}', diversity: '{{conversation7_diversity}}' },
                'conversation-8': { category: '{{conversation8_category}}', complexity: '{{conversation8_complexity}}', usecase: '{{conversation8_usecase}}', diversity: '{{conversation8_diversity}}' },
                'conversation-9': { category: '{{conversation9_category}}', complexity: '{{conversation9_complexity}}', usecase: '{{conversation9_usecase}}', diversity: '{{conversation9_diversity}}' }
            };

            const titles = {
                'conversation-1': '{{conversation1_title}}',
                'conversation-2': '{{conversation2_title}}',
                'conversation-3': '{{conversation3_title}}',
                'conversation-4': '{{conversation4_title}}',
                'conversation-5': '{{conversation5_title}}',
                'conversation-6': '{{conversation6_title}}',
                'conversation-7': '{{conversation7_title}}',
                'conversation-8': '{{conversation8_title}}',
                'conversation-9': '{{conversation9_title}}'
            };

            const selectedArray = Array.from(selectedConversations);
            const selectedData = selectedArray.map(id => ({ id, ...conversations[id], title: titles[id] }));

            // Analyze diversity
            const diversityTypes = [...new Set(selectedData.map(c => c.diversity))];
            const complexityTypes = [...new Set(selectedData.map(c => c.complexity))];
            const categoryTypes = [...new Set(selectedData.map(c => c.category))];

            // Calculate coverage scores
            const diversityScore = diversityTypes.length;
            const complexityScore = complexityTypes.length;
            const categoryScore = categoryTypes.length;
            
            // Ideal criteria for good test coverage
            const idealCriteria = {
                diversity: 3, // At least 3 different use case types
                complexity: 2, // At least 2 complexity levels
                categories: 3 // At least 3 different conversation categories
            };

            let feedbackHTML = '<h3>{{dynamic_feedback_title}}</h3>';
            
            // Overall score
            const totalScore = Math.min(diversityScore, 3) + Math.min(complexityScore, 2) + Math.min(categoryScore, 3);
            const maxScore = 8;
            feedbackHTML += `<div class="score-section">Test Coverage Score: ${totalScore}/${maxScore}</div>`;

            // Selected conversations
            feedbackHTML += '<div class="feedback-section">';
            feedbackHTML += '<h4>Your Selected Test Set</h4>';
            selectedData.forEach(conv => {
                feedbackHTML += `<div class="feedback-item">
                    <strong>${conv.title}</strong> 
                    <span class="category-badge ${conv.complexity.toLowerCase()}">${conv.category}</span>
                    <span class="complexity-badge ${conv.complexity.toLowerCase()}">${conv.complexity}</span>
                    <br><em>Use case: ${conv.usecase}</em>
                </div>`;
            });
            feedbackHTML += '</div>';

            // Coverage analysis
            feedbackHTML += '<div class="feedback-section">';
            feedbackHTML += '<h4>Coverage Analysis</h4>';
            
            // Diversity coverage
            const diversityGood = diversityScore >= idealCriteria.diversity;
            feedbackHTML += `<div class="coverage-item ${diversityGood ? 'good' : 'needs-improvement'}">
                <span class="coverage-badge ${diversityGood ? 'good' : 'warning'}">
                    ${diversityGood ? 'GOOD' : 'IMPROVE'}
                </span>
                <strong>Use Case Diversity:</strong> ${diversityScore}/3 different types covered
                ${diversityGood ? '' : ' - Consider adding more diverse conversation types'}
            </div>`;

            // Complexity coverage
            const complexityGood = complexityScore >= idealCriteria.complexity;
            feedbackHTML += `<div class="coverage-item ${complexityGood ? 'good' : 'needs-improvement'}">
                <span class="coverage-badge ${complexityGood ? 'good' : 'warning'}">
                    ${complexityGood ? 'GOOD' : 'IMPROVE'}
                </span>
                <strong>Complexity Range:</strong> ${complexityScore} complexity levels covered
                ${complexityGood ? '' : ' - Include both simple and complex requests'}
            </div>`;

            // Category coverage
            const categoryGood = categoryScore >= idealCriteria.categories;
            feedbackHTML += `<div class="coverage-item ${categoryGood ? 'good' : 'needs-improvement'}">
                <span class="coverage-badge ${categoryGood ? 'good' : 'warning'}">
                    ${categoryGood ? 'GOOD' : 'IMPROVE'}
                </span>
                <strong>Category Breadth:</strong> ${categoryScore} conversation categories covered
                ${categoryGood ? '' : ' - Try to include more conversation types'}
            </div>`;

            feedbackHTML += '</div>';

            // Recommendations
            feedbackHTML += '<div class="feedback-section">';
            feedbackHTML += '<h4>Testing Insights</h4>';

            if (totalScore >= 7) {
                feedbackHTML += '<div class="overall-feedback success">Excellent test set! Your selections provide comprehensive coverage of customer scenarios with good diversity across use cases, complexity levels, and conversation types. This will effectively test the chatbot\'s capabilities.</div>';
            } else if (totalScore >= 5) {
                feedbackHTML += '<div class="overall-feedback good">Good test set! You\'ve covered most important scenarios. Consider whether you could improve diversity in the areas marked above for even better test coverage.</div>';
            } else {
                feedbackHTML += '<div class="overall-feedback needs-work">Your test set covers some scenarios, but could be more diverse. Try selecting conversations that span different categories and complexity levels for better test coverage.</div>';
            }

            // Testing principles
            feedbackHTML += `<div class="testing-principles">
                <h5>Key Testing Principles Applied:</h5>
                <ul>
                    <li><strong>Scenario Diversity:</strong> ${diversityTypes.join(', ')}</li>
                    <li><strong>Complexity Range:</strong> ${complexityTypes.join(', ')}</li>
                    <li><strong>Conversation Types:</strong> ${categoryTypes.join(', ')}</li>
                </ul>
            </div>`;

            feedbackHTML += '</div>';
            
            feedbackHTML += '<a href="{{next_task_link}}" class="next-task">{{next_task_button_text}}</a>';
            
            document.getElementById('feedback').innerHTML = feedbackHTML;
        }

        // Initialize progress counter
        updateProgress();
    </script>
</body>
</html>